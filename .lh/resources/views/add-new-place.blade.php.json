{
    "sourceFile": "resources/views/add-new-place.blade.php",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 1,
            "patches": [
                {
                    "date": 1701284690172,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1701284716216,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,611 @@\n+@php\n+    $locale = session()->get('locale');\n+    if ($locale == null) {\n+        $locale = 'en';\n+    }\n+@endphp\n+@extends('layouts.app')\n+\n+@section('main')\n+    <div class=\"p-6 lg:p-12\">\n+        <a href=\"/\" class=\"\">\n+            <img src=\"{{ asset('img/icons/arrow.png') }}\" class=\"arrow\">\n+\n+        </a>\n+\n+        <div class=\"parentDiv relative pt-20\" x-cloak x-data=\"{ tab: '{{ $type }}', showMore: false }\"\n+            :class=\"tab == 'place' ? 'placeTab' : 'observationTab'\">\n+\n+            <div class=\"flex items-center justify-center\">\n+                <div class=\"-mr-1 cursor-pointer\" x-show=\"tab=='place'\">\n+                    <div class=\"flex flex-col w-[84px] justify-center items-center\">\n+                        <div class=\"bg-[#2d9bf0] border-2 border-white rounded-full\"\n+                            :class=\"tab == 'place' ?\n+                                'bg-[#2d9bf0] z-10 p-[26px] placeTabActive' :\n+                                'bg-[#2d9bf0]/70 p-[40px]'\">\n+                            <img src=\"{{ asset('new_img/image.png') }}\" class=\"w-7 h-7\"\n+                                :class=\"tab == 'place' ? 'block' : 'hidden'\" id=\"place\" alt=\"\">\n+                        </div>\n+\n+                    </div>\n+                </div>\n+                <div class=\"-ml-1 cursor-pointer\" x-show=\"tab=='observation'\">\n+                    <div class=\"flex flex-col w-[75px] justify-center items-center\">\n+\n+                        <div class=\"flex items-center justify-center border-2 border-white rounded-full\"\n+                            :class=\"tab == 'observation' || tab == 'observation1' ?\n+                                'bg-[#ffa726] z-10 p-[20px] observationTabActive' :\n+                                'bg-[#ffa726]/70 p-[40px]'\">\n+                            <div class=\"flex items-center justify-center w-10 h-10 text-2xl\"\n+                                :class=\"tab == 'observation' || tab == 'observation1' ? 'block' :\n+                                    'hidden'\"\n+                                id=\"observation\" alt=\"\">üîç</div>\n+                        </div>\n+\n+                    </div>\n+                </div>\n+            </div>\n+\n+\n+\n+            <div class=\"placeSubTab flex flex-col items-center justify-center\" x-data=\"{\n+                placeSubtab: 'add',\n+                \n+                searchQueryPlace:'',\n+                placeTitle: 'Want to pin a place that has not been mapped before? Add a layer by giving it a name. Provide more details by adding a description, and uploading a photo.',\n+                placeInput: 'Enter a new place',\n+                active: '',\n+                placeModel: 'parent'\n+            }\" x-show=\"tab=='place'\"\n+                :class=\"placeSubtab == 'choose' ? 'choose' : 'add'\">\n+                <button class=\"hidden openPlaceModel\"\n+                    @click=\"tab='place';placeSubtab='choose';placeTitle='Choose tags or add a new place';placeInput='Browse place tags'\"></button>\n+                <button class=\"hidden OpenSubPlaceModel\" @click=\"tab='place';placeModel='child'\"></button>\n+\n+\n+                <div class=\"PlaceItems w-full\" x-show=\"placeModel=='parent'\"\n+                    :class=\"placeModel == 'parent' ? 'parent' : 'child'\">\n+                    <div class=\"flex flex-col items-center justify-center w-full mt-12 mb-12\">\n+                        <input  type=\"text\" :placeholder=\"placeInput\" id=\"searchQueryPlace\" x-model=\"searchQueryPlace\" name=\"place_name\"\n+                            class=\"w-full px-4 py-2 bg-white rounded-full\">\n+                        <span id=\"err\" class=\"text-center text-red-500\"></span>\n+                        <div class=\"mt-2 italic font-normal text-center\" x-text=\"placeTitle\"></div>\n+\n+                    </div>\n+\n+                    <div class=\"grid grid-cols-4 italic font-semibold gap-10\" x-show=\"placeSubtab=='choose'\">\n+                        <div class=\"flex flex-col items-center cursor-pointer\">\n+                            <button\n+                                @click=\"placeSubtab='add';placeTitle='Want to pin a place that has not been mapped before? Add a layer by giving it a name. Provide more details by adding a description, and uploading a photo.';placeInput='Enter a new place'\">\n+                                <div class=\"rounded-full border-site border-4 p-[22px] bg-site\">\n+                                    <svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\"\n+                                        stroke-width=\"3\" stroke=\"#ffff\" class=\"w-6 h-6 font-bold color-site\">\n+                                        <path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M12 6v12m6-6H6\" />\n+                                    </svg>\n+                                </div>\n+                                <div class=\"mt-4 text-black font-bold\">Add new</div>\n+                            </button>\n+                        </div>\n+\n+\n+\n+                        @foreach ($allPlaces as $key => $place)\n+                            <div x-show=\"(showMore || {{ $key }} < 2) && (searchQueryPlace === '' || '{{ strtolower($place->name) }}'.includes(searchQueryPlace.toLowerCase()))\"\n+                                class=\"flex flex-col items-center cursor-pointer\" @click=\"active='PL_{{ $place->id }}'\">\n+                                <div data-place=\"{{ json_encode(['id' => $place->id, 'name' => $place->name, 'child' => $place->subplaces]) }}\"\n+                                    class=\"w-[76px] h-[76px] rounded-full bg-[#2d9bf0]\"\n+                                    :class=\"active == 'PL_{{ $place->id }}' ? 'border-4 border-[#12CDD4] placeActive' : ''\">\n+                                    <div class=\"flex align-item-center justify-center items-center h-full\">\n+                                        <img src=\"{{ asset('new_img/image.png') }}\" class=\"w-7 h-7\" />\n+                                    </div>\n+                                </div>\n+                                <span class=\"mt-4 text-black font-normal\">{{ $place->name }}</span>\n+                            </div>\n+                        @endforeach\n+                        <div x-show=\"!showMore\" class=\"cursor-pointer\">\n+                            <button @click=\"showMore = true; height = '100vh'\">\n+                                <div class=\"rounded-full border-site border-4 p-[22px]\">\n+                                    <svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\"\n+                                        stroke-width=\"3\" stroke=\"currentColor\" class=\"w-6 h-6 font-bold color-site\">\n+                                        <path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M12 6v12m6-6H6\" />\n+                                    </svg>\n+                                </div>\n+                                <div class=\"mt-4 text-black font-normal\">See more</div>\n+                            </button>\n+                        </div>\n+                    </div>\n+                </div>\n+\n+                <div class=\"mt-12 mb-12 text-center\" x-data=\"{ subactive: '' }\" x-show=\"placeModel=='child'\">\n+                    <div class=\"placeparent mb-10 font-semibold text-xl\"></div>\n+                    <div class=\"grid grid-cols-3 italic font-semibold text-xl gap-10 subPlaceItems\">\n+\n+                    </div>\n+                </div>\n+\n+                <div x-show=\"placeSubtab=='choose'\" class=\"px-5 mt-2 text-center\">\n+\n+                    Tap \"submit\" to pin this place to the map and share it with other users.\n+                    Provide more details through rating, adding a description, and uploading a photo.\n+\n+\n+                </div>\n+\n+                <div class=\"flex items-center justify-between w-2/3 pt-28 pb-16 font-semibold\">\n+                    <label class=\"flex flex-col items-center gap-1 cursor-pointer\" for=\"image-upload\">\n+                        <input id=\"image-upload\" type=\"file\" class=\"hidden place_image\" accept=\".jpg, .png\">\n+                        <img src=\"{{ asset('img/cam-2.PNG') }}\" alt=\"\" class=\"w-10 h-9\">\n+                        <div class=\"text-sm\">Upload image</div>\n+                    </label>\n+\n+                    <div class=\"relative\" x-data=\"{ placeText: false }\">\n+                        <div @click=\"placeText = !placeText\" class=\"flex flex-col items-center gap-1 cursor-pointer\">\n+                            <img src=\"{{ asset('img/msg.PNG') }}\" alt=\"\" class=\"w-10 h-9\">\n+                            <div class=\"text-sm\">Add description</div>\n+                        </div>\n+                        <textarea class=\"font-normal place_description absolute px-2 py-2 bg-white rounded-xl w-[300px] right-0\"\n+                            x-show=\"placeText\"></textarea>\n+                    </div>\n+\n+                </div>\n+\n+            </div>\n+\n+            <div class=\"observationSubTab flex flex-col items-center justify-center\" x-data=\"{\n+                observationSubtab: 'add',\n+                searchQueryObservation: '',\n+                observationTitle: 'Want to pin an observation that has not been mapped before? Add a layer by giving it a name. Provide more details through rating, adding a description, and uploading a photo.',\n+                observationInput: 'Enter a new observation',\n+                active: '',\n+                observationModel: 'parent'\n+            }\"\n+                x-show=\"tab=='observation'\" :class=\"observationSubtab == 'choose' ? 'choose' : 'add'\">\n+\n+                <button class=\"hidden OpenObservationModel\"\n+                    @click=\"tab='observation';observationSubtab='choose';observationTitle='Choose tags or add a new observation';observationInput='Browse observation'\"></button>\n+                <button class=\"hidden OpenSubObservationModel\"\n+                    @click=\"tab='observation';observationModel='child'\"></button>\n+\n+\n+                <div class=\"ObservationItems w-full\" x-show=\"observationModel=='parent'\"\n+                    :class=\"observationModel == 'parent' ? 'parent' : 'child'\">\n+                    <div class=\"flex flex-col items-center justify-center mt-12 mb-12 w-full\">\n+                        <input type=\"text\" name=\"observation_name\" :placeholder=\"observationInput\"\n+                            x-model=\"searchQueryObservation\" id=\"searchQueryObservation\" class=\"w-full px-4 py-2 bg-white rounded-full\">\n+                        <div class=\"mt-2 italic font-normal text-center\" x-text=\"observationTitle\"></div>\n+                    </div>\n+                    <div class=\"flex items-start justify-center gap-10 mt-6 mb-6 italic font-semibold\">\n+                        <div class=\"grid grid-cols-4 italic font-semibold gap-10\" x-show=\"observationSubtab=='choose'\">\n+                            <div class=\"flex flex-col items-center cursor-pointer\">\n+                                <button\n+                                    @click=\"observationSubtab='add';observationTitle='Want to pin an observation that has not been mapped before? Add a layer by giving it a name. Provide more details through rating, adding a description, and uploading a photo.';observationInput='Enter a new observation'\">\n+                                    <div class=\"rounded-full border-site border-4 p-[22px] bg-site\">\n+                                        <svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\"\n+                                            stroke-width=\"3\" stroke=\"#ffff\" class=\"w-6 h-6 font-bold color-site\">\n+                                            <path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M12 6v12m6-6H6\" />\n+                                        </svg>\n+                                    </div>\n+                                    <div class=\"mt-4 text-black font-bold\">Add new</div>\n+                                </button>\n+                            </div>\n+                            @foreach ($allObservations as $key => $observation)\n+                                <div x-data=\"{ active: false }\"\n+                                    x-show=\"(showMore || {{ $key }} < 2) && (searchQueryObservation === '' || '{{ strtolower($observation->name) }}'.includes(searchQueryObservation.toLowerCase()))\"\n+                                    class=\"flex flex-col items-center cursor-pointer\"\n+                                    @click=\"active = !active ? 'OB_{{ $observation->id }}' : false\">\n+                                    <div data-observations=\"{{ json_encode(['id' => $observation->id, 'name' => $observation->name, 'child' => $observation->subobservs]) }}\"\n+                                        class=\"w-[76px] h-[76px] rounded-full bg-[#ffa726]\"\n+                                        :class=\"active == 'OB_{{ $observation->id }}' ?\n+                                            'border-4 border-[#12CDD4] observationActive' : ''\">\n+                                        <div class=\"flex align-item-center justify-center items-center h-full\">\n+                                            <img src=\"{{ asset('new_img/sad.png') }}\" alt=\"\"\n+                                                class=\"w-8 h-8 -mr-1\">\n+                                            <img src=\"{{ asset('new_img/happy.png') }}\" alt=\"\"\n+                                                class=\"w-8 h-8 -ml-1\">\n+                                        </div>\n+                                    </div>\n+                                    <span class=\"mt-4 text-black font-normal\">{{ $observation->name }}</span>\n+                                </div>\n+                            @endforeach\n+\n+                            <div x-show=\"!showMore\" class=\"flex flex-col items-center justify-center cursor-pointer\">\n+                                <button @click=\"showMore = true; height = '100vh'\" type=\"button\">\n+                                    <div class=\"rounded-full border-[#ffa726] border-4  p-[22px]\">\n+                                        <svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\"\n+                                            stroke-width=\"3\" stroke=\"currentColor\"\n+                                            class=\"w-6 h-6 font-bold text-[#ffa726]\">\n+                                            <path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M12 6v12m6-6H6\" />\n+                                        </svg>\n+                                    </div>\n+                                    <div class=\"mt-4 text-black font-normal\">See more</div>\n+                                </button>\n+                            </div>\n+                        </div>\n+                    </div>\n+                </div>\n+                <div class=\"mt-12 mb-12 text-center\" x-show=\"observationModel=='child'\">\n+                    <div class=\"grid grid-cols italic font-semibold text-xl gap-10 subObservationItems\">\n+\n+                    </div>\n+                </div>\n+\n+\n+\n+                <div x-show=\"observationSubtab=='add'\" x-data=\"{ feelActive: 'feel__1' }\"\n+                    class=\"flex flex-wrap items-center justify-center gap-2 italic font-semibold w-full \">\n+                    @foreach ($feelings as $feeling)\n+                        <div data-feeling_id=\"{{ $feeling->id }}\" @click=\"feelActive='feel_{{ $feeling->id }}'\"\n+                            class=\"cursor-pointer rounded-full\"\n+                            :class=\"feelActive == 'feel_{{ $feeling->id }}' ? 'border-4 border-[#12CDD4] feelingActive' : ''\">\n+                            <img class=\"w-12 h-12 sm:w-16 sm:h-16\" src=\"{{ asset($feeling->image) }}\" alt=\"\">\n+                        </div>\n+                    @endforeach\n+\n+                </div>\n+\n+\n+                <div x-show=\"observationSubtab=='choose'\" class=\"px-5 mt-2 text-center\">\n+\n+                    Tap \"submit\" to pin this observation to the map and share it with other users.\n+                    Provide more details through rating, adding a description, and uploading a photo.\n+\n+\n+                </div>\n+                <div class=\"flex items-center justify-between w-2/3 pt-28 pb-16 font-semibold\">\n+                    <label for=\"obser-image-upload\" class=\"flex flex-col items-center gap-1 cursor-pointer\">\n+                        <input id=\"obser-image-upload\" type=\"file\" class=\"hidden observation_image\"\n+                            accept=\".jpg, .png\">\n+                        <img src=\"{{ asset('img/cam.PNG') }}\" alt=\"\" class=\"w-10 h-9\">\n+                        <div class=\"text-sm\">Upload image</div>\n+                    </label>\n+\n+\n+\n+                    <div class=\"relative\" x-data=\"{ observationText: false }\">\n+                        <div @click=\"observationText = !observationText\"\n+                            class=\"flex flex-col items-center gap-1 cursor-pointer\">\n+                            <img src=\"{{ asset('img/msg-2.PNG') }}\" alt=\"\" class=\"w-10 h-9\">\n+                            <div class=\"text-sm\">Add description</div>\n+                        </div>\n+                        <textarea class=\"font-normal observation_description absolute px-2 py-2 bg-white rounded-xl w-[300px] right-0\"\n+                            x-show=\"observationText\"></textarea>\n+                    </div>\n+\n+                </div>\n+\n+\n+            </div>\n+\n+\n+            <div class=\"fixed left-0 right-0 bg-white py-4 bottom-0 z-[100]\">\n+                <div class=\"flex items-center justify-center gap-6\">\n+                    <a href=\"/\"\n+                        class=\"flex cursor-pointer items-center justify-center border-2 border-site gap-2 px-8 py-3 text-lg font-extrabold color-site bg-white rounded-3xl transition-all\">\n+                        Close\n+                    </a>\n+\n+                    <div\n+                        class=\"submitDataAll flex cursor-pointer items-center border-2 border-site justify-center gap-2 px-8 py-3 text-lg font-extrabold text-white bg-[#2d9bf0] rounded-3xl  hover:bg-[#268ede] transition-all\">\n+                        Submit\n+                    </div>\n+                </div>\n+            </div>\n+        </div>\n+\n+    </div>\n+\n+    <script>\n+\n+$(document).ready(function () {\n+    setTimeout(() => {\n+        $('#searchQueryPlace').val(' ');\n+        var inputEvent = new Event('input', { bubbles: true });\n+        $('#searchQueryPlace')[0].dispatchEvent(inputEvent);\n+        \n+        $('#searchQueryObservation').val(' ');\n+        var inputEvent = new Event('input', { bubbles: true });\n+        $('#searchQueryObservation')[0].dispatchEvent(inputEvent);\n+    }, 1);\n+});\n+\n+        let place_data = {\n+            place_name: '',\n+            place_id: '',\n+            child_place_id: '',\n+            observation_name: '',\n+            feeling_id: '',\n+            observations: '',\n+            place_description: '',\n+            observation_description: '',\n+            latitude: '',\n+            longitude: '',\n+            tab: '{{ $type }}',\n+        };\n+        var fileInput_place = '';\n+        var fileInput_observation = '';\n+\n+        if (navigator.geolocation) {\n+            getposition();\n+        } else {\n+            alert(\"Geolocation is not supported by this browser.\");\n+        }\n+\n+        function getposition(success, fail) {\n+            if (navigator && navigator.geolocation) {\n+                navigator.geolocation.getCurrentPosition(\n+                    function(pos) {\n+                        place_data['latitude'] = pos.coords.latitude;\n+                        place_data['longitude'] = pos.coords.longitude;\n+                    }\n+                );\n+            }\n+        }\n+\n+\n+\n+        $('body').on('click', '.submitDataAll', function() {\n+\n+            var parentDiv = $(this).closest('.parentDiv');\n+\n+\n+\n+\n+\n+\n+            if (parentDiv.hasClass('placeTab')) {\n+                tab = 'place';\n+                place_data['tab'] = tab;\n+\n+                fileInput_place = $(\".place_image\")[0].files[0];\n+                place_data['place_description'] = parentDiv.find('.place_description').val();\n+\n+\n+                if (parentDiv.find('.' + tab + 'SubTab').hasClass('add')) {\n+                    // add new place\n+                    var name = parentDiv.find('input[name=\"place_name\"]').val();\n+                    if (name == '') {\n+                        parentDiv.find('input[name=\"place_name\"]').addClass('border-red-500');\n+                        return false;\n+                    }\n+                    place_data['place_name'] = name;\n+                } else if (parentDiv.find('.' + tab + 'SubTab').hasClass('choose') && parentDiv.find('.PlaceItems')\n+                    .hasClass('parent')) {\n+\n+                    var place_detail = parentDiv.find('.placeActive').data('place');\n+\n+\n+                    if (typeof place_detail === 'undefined') {\n+                        return false;\n+                    }\n+                    place_data['place_id'] = place_detail.id;\n+                    if (place_detail.child.length > 0) {\n+                        $('.placeparent').text(place_detail.name);\n+                        var allHtml = '';\n+                        place_detail.child.forEach(place => {\n+                            allHtml += `\n+                            <div class=\"flex flex-col items-center cursor-pointer\" @click=\"subactive='SPL_${place.id}'\">\n+                                                <div data-subplaceid=\"${place.id}\" class=\"w-[76px] h-[76px] rounded-full bg-[#2d9bf0]\"\n+                                                :class=\"subactive == 'SPL_${place.id}' ? 'border-4 border-[#12CDD4] subplaceActive' : ''\">\n+                                                    <div class=\"flex align-item-center justify-center items-center h-full\">\n+                                                        <img src=\"{{ asset('new_img/image.png') }}\" class=\"w-7 h-7\" />\n+                                                    </div>\n+                                                </div>\n+                                                <span class=\"mt-4 text-black font-normal text-base\">${place.name}</span>\n+                                            </div>\n+                            `;\n+                        });\n+                        $('.subPlaceItems').html(allHtml);\n+                        $('.OpenSubPlaceModel').click();\n+                        return false;\n+                    } else {\n+                        submitDetailData(place_data);\n+                    }\n+\n+                } else if (parentDiv.find('.' + tab + 'SubTab').hasClass('choose') && parentDiv.find('.PlaceItems')\n+                    .hasClass('child')) {\n+\n+\n+                    var subplace_id = parentDiv.find('.subplaceActive').data('subplaceid');\n+                    place_data['child_place_id'] = subplace_id ? subplace_id : '';\n+                }\n+            }\n+\n+            if (parentDiv.hasClass('observationTab')) {\n+                tab = 'observation';\n+                place_data['tab'] = tab;\n+                fileInput_observation = $(\".observation_image\")[0].files[0];\n+                place_data['observation_description'] = parentDiv.find('.observation_description').val();\n+\n+                if (parentDiv.find('.' + tab + 'SubTab').hasClass('add')) {\n+                    // add new observation\n+                    var name = parentDiv.find('input[name=\"observation_name\"]').val();\n+                    var feeling = parentDiv.find('.feelingActive').data('feeling_id');\n+\n+                    if (name === '' || typeof feeling === 'undefined') {\n+                        parentDiv.find('input[name=\"observation_name\"]').addClass('border-red-500');\n+                        return false;\n+                    }\n+                    place_data['observation_name'] = name;\n+                    place_data['feeling_id'] = feeling;\n+                } else if (parentDiv.find('.' + tab + 'SubTab').hasClass('choose') && parentDiv.find(\n+                        '.ObservationItems').hasClass('parent')) {\n+                    // choose observation\n+                    var observations_detail = [];\n+                    parentDiv.find('.observationActive').each(function() {\n+                        var data = $(this).data('observations');\n+                        observations_detail.push(data);\n+                    });\n+                    var allHtml = '';\n+                    if (observations_detail.length == 0) {\n+                        return false;\n+                    }\n+                    observations_detail.forEach(function(observation) {\n+\n+                        allHtml +=\n+                            `<div data-observation_id=\"${observation.id}\"><div class=\"mb-4\">${observation.name}</div>`;\n+\n+                        var feelingHtml = `\n+                                <div x-data=\"{ feelActive${observation.id}: 'feel_${observation.id}_1' }\" class=\"flex flex-wrap items-center justify-center gap-2 italic font-semibold w-full \">\n+                                    @foreach ($feelings as $feeling)\n+                                        <div data-feeling_id=\"{{ $feeling->id }}\"\n+                                            @click=\"feelActive${observation.id}='feel_${observation.id}_{{ $feeling->id }}'\"\n+                                            class=\"cursor-pointer rounded-full\"\n+                                            :class=\"feelActive${observation.id} == 'feel_${observation.id}_{{ $feeling->id }}' ? 'border-4 border-[#12CDD4] feelingActive' : ''\"\n+                                            >\n+                                            <img class=\"w-12 h-12 sm:w-16 sm:h-16\" src=\"{{ asset($feeling->image) }}\" alt=\"\">\n+                                        </div>\n+                                    @endforeach\n+                                </div>\n+                    `;\n+\n+                        if (observation.child.length === 0) {\n+                            allHtml += `\n+                            <div data-subobservation_id=\"\" class=\"flex items-center justify-between mb-10\">\n+                            ${feelingHtml}\n+                            </div>\n+                        `;\n+                        } else {\n+                            observation.child.forEach(observ => {\n+                                allHtml += `\n+                            <div data-subobservation_id=\"${observ.id}\" class=\"flex gap-2 lg:gap-20 items-center justify-between mb-10\">\n+                                <div class=\"flex flex-col items-center w-[160px]\">\n+                                    <div class=\"w-[76px] h-[76px] rounded-full bg-[#ffa726]\">\n+                                        <div class=\"flex align-item-center justify-center items-center h-full\">\n+                                            <img src=\"{{ asset('new_img/sad.png') }}\" alt=\"\"\n+                                                            class=\"w-8 h-8 -mr-1\"> <img\n+                                                            src=\"{{ asset('new_img/happy.png') }}\" alt=\"\"\n+                                                            class=\"w-8 h-8 -ml-1\">\n+                                        </div>\n+                                    </div>\n+                                    <span class=\"mt-1 text-black font-normal text-base\">${observ.name}</span>\n+                                </div>\n+\n+                                ${feelingHtml}\n+                            </div>`;\n+                            });\n+                        }\n+\n+                        allHtml += `</div>`;\n+                    });\n+\n+                    $('.subObservationItems').html(allHtml);\n+                    $('.OpenSubObservationModel').click();\n+                    return false;\n+                } else if (parentDiv.find('.' + tab + 'SubTab').hasClass('choose') && parentDiv.find(\n+                        '.ObservationItems').hasClass('child')) {\n+\n+                    var dataList = [];\n+                    parentDiv.find('.feelingActive').each(function() {\n+                        var observationId = $(this).closest('[data-observation_id]').data('observation_id');\n+                        var subobservationId = $(this).closest('[data-subobservation_id]').data(\n+                            'subobservation_id');\n+                        var feelingId = $(this).data('feeling_id');\n+\n+                        dataList.push({\n+                            observation_id: observationId,\n+                            child_observation_id: subobservationId,\n+                            feeling_id: feelingId\n+                        });\n+                    });\n+                    place_data['observations'] = dataList;\n+                }\n+            }\n+            // console.log(place_data);\n+            submitDetailData(place_data);\n+        });\n+\n+        var totalswal = 0;\n+\n+        function submitDetailData(place_data) {\n+\n+            place_data['update'] = place_data.tab;\n+\n+            @if ($edit_id)\n+                place_data['place_detail_id'] = {{ $edit_id }};\n+            @endif\n+\n+            const formData = new FormData();\n+            if (fileInput_place) {\n+                formData.append('place_image', fileInput_place);\n+            }\n+            if (fileInput_observation) {\n+                formData.append('observation_image', fileInput_observation);\n+            }\n+\n+            formData.append('place_data', JSON.stringify(place_data));\n+\n+            $.ajaxSetup({\n+                headers: {\n+                    'X-CSRF-TOKEN': $('meta[name=\"csrf-token\"]').attr('content')\n+                }\n+            });\n+\n+\n+            $.ajax({\n+                type: 'POST',\n+                url: \"/map/add/place\",\n+                data: formData,\n+                contentType: false,\n+                processData: false,\n+                success: function(data) {\n+                    if (data.status == 'success') {\n+                        place_data['place_name'] = '';\n+                        place_data['observation_name'] = '';\n+                        place_data['place_id'] = data.place_id;\n+\n+                        var reverse_tab = data.tab == 'place' ? 'observation' : 'place';\n+                        if (data.status == 'success') {\n+\n+                            if (totalswal >= 1) {\n+                                window.location.href = '/';\n+                            } else {\n+                                totalswal = totalswal + 1;\n+                                place_data['place_detail_id'] = data.place_detail_id;\n+                                place_data['update'] = reverse_tab;\n+\n+                                @if(!$only)\n+                                    swal({\n+                                        title: \"Success!\",\n+                                        text: data.tab.charAt(0).toUpperCase() + data.tab.slice(1) + \" \" +\n+                                            data\n+                                            .msg + \" Do you want to add \" + reverse_tab + \" tag?\",\n+                                        icon: \"success\",\n+                                        buttons: [\"Close\", \"Continue\"],\n+                                    }).then((userConfirmed) => {\n+                                        if (userConfirmed) {\n+                                            if (reverse_tab == 'place') {\n+                                                $('.openPlaceModel').click();\n+                                            } else {\n+                                                $('.OpenObservationModel').click();\n+                                            }\n+                                        } else {\n+                                            window.location.href = '/';\n+                                            // $('.closeAddProcess').click();\n+                                        }\n+                                    });\n+                                @else\n+                                    window.location.href = '/';\n+                                @endif\n+\n+\n+                                \n+                            }\n+\n+\n+                        }\n+                    } else {\n+                        swal({\n+                            title: \"Failed!\",\n+                            text: data.msg,\n+                            icon: \"error\"\n+                        });\n+                    }\n+\n+\n+                },\n+\n+            });\n+\n+        }\n+    </script>\n+@endsection\n"
                }
            ],
            "date": 1701284690172,
            "name": "Commit-0",
            "content": "@php\n    $locale = session()->get('locale');\n    if ($locale == null) {\n        $locale = 'en';\n    }\n@endphp\n@extends('layouts.app')\n\n@section('main')\n    <div class=\"p-6 lg:p-12\">\n        <a href=\"/\" class=\"\">\n            <img src=\"{{ asset('img/icons/arrow.png') }}\" class=\"arrow\">\n\n        </a>\n\n        <div class=\"parentDiv relative pt-20\" x-cloak x-data=\"{ tab: '{{ $type }}', showMore: false }\"\n            :class=\"tab == 'place' ? 'placeTab' : 'observationTab'\">\n\n            <div class=\"flex items-center justify-center\">\n                <div class=\"-mr-1 cursor-pointer\" x-show=\"tab=='place'\">\n                    <div class=\"flex flex-col w-[84px] justify-center items-center\">\n                        <div class=\"bg-[#2d9bf0] border-2 border-white rounded-full\"\n                            :class=\"tab == 'place' ?\n                                'bg-[#2d9bf0] z-10 p-[26px] placeTabActive' :\n                                'bg-[#2d9bf0]/70 p-[40px]'\">\n                            <img src=\"{{ asset('new_img/image.png') }}\" class=\"w-7 h-7\"\n                                :class=\"tab == 'place' ? 'block' : 'hidden'\" id=\"place\" alt=\"\">\n                        </div>\n\n                    </div>\n                </div>\n                <div class=\"-ml-1 cursor-pointer\" x-show=\"tab=='observation'\">\n                    <div class=\"flex flex-col w-[75px] justify-center items-center\">\n\n                        <div class=\"flex items-center justify-center border-2 border-white rounded-full\"\n                            :class=\"tab == 'observation' || tab == 'observation1' ?\n                                'bg-[#ffa726] z-10 p-[20px] observationTabActive' :\n                                'bg-[#ffa726]/70 p-[40px]'\">\n                            <div class=\"flex items-center justify-center w-10 h-10 text-2xl\"\n                                :class=\"tab == 'observation' || tab == 'observation1' ? 'block' :\n                                    'hidden'\"\n                                id=\"observation\" alt=\"\">üîç</div>\n                        </div>\n\n                    </div>\n                </div>\n            </div>\n\n\n\n            <div class=\"placeSubTab flex flex-col items-center justify-center\" x-data=\"{\n                placeSubtab: 'add',\n                \n                searchQueryPlace:'',\n                placeTitle: 'Want to pin a place that has not been mapped before? Add a layer by giving it a name. Provide more details by adding a description, and uploading a photo.',\n                placeInput: 'Enter a new place',\n                active: '',\n                placeModel: 'parent'\n            }\" x-show=\"tab=='place'\"\n                :class=\"placeSubtab == 'choose' ? 'choose' : 'add'\">\n                <button class=\"hidden openPlaceModel\"\n                    @click=\"tab='place';placeSubtab='choose';placeTitle='Choose tags or add a new place';placeInput='Browse place tags'\"></button>\n                <button class=\"hidden OpenSubPlaceModel\" @click=\"tab='place';placeModel='child'\"></button>\n\n\n                <div class=\"PlaceItems w-full\" x-show=\"placeModel=='parent'\"\n                    :class=\"placeModel == 'parent' ? 'parent' : 'child'\">\n                    <div class=\"flex flex-col items-center justify-center w-full mt-12 mb-12\">\n                        <input  type=\"text\" :placeholder=\"placeInput\" id=\"searchQueryPlace\" x-model=\"searchQueryPlace\" name=\"place_name\"\n                            class=\"w-full px-4 py-2 bg-white rounded-full\">\n                        <span id=\"err\" class=\"text-center text-red-500\"></span>\n                        <div class=\"mt-2 italic font-normal text-center\" x-text=\"placeTitle\"></div>\n\n                    </div>\n\n                    <div class=\"grid grid-cols-4 italic font-semibold gap-10\" x-show=\"placeSubtab=='choose'\">\n                        <div class=\"flex flex-col items-center cursor-pointer\">\n                            <button\n                                @click=\"placeSubtab='add';placeTitle='Want to pin a place that has not been mapped before? Add a layer by giving it a name. Provide more details by adding a description, and uploading a photo.';placeInput='Enter a new place'\">\n                                <div class=\"rounded-full border-site border-4 p-[22px] bg-site\">\n                                    <svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\"\n                                        stroke-width=\"3\" stroke=\"#ffff\" class=\"w-6 h-6 font-bold color-site\">\n                                        <path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M12 6v12m6-6H6\" />\n                                    </svg>\n                                </div>\n                                <div class=\"mt-4 text-black font-bold\">Add new</div>\n                            </button>\n                        </div>\n\n\n\n                        @foreach ($allPlaces as $key => $place)\n                            <div x-show=\"(showMore || {{ $key }} < 2) && (searchQueryPlace === '' || '{{ strtolower($place->name) }}'.includes(searchQueryPlace.toLowerCase()))\"\n                                class=\"flex flex-col items-center cursor-pointer\" @click=\"active='PL_{{ $place->id }}'\">\n                                <div data-place=\"{{ json_encode(['id' => $place->id, 'name' => $place->name, 'child' => $place->subplaces]) }}\"\n                                    class=\"w-[76px] h-[76px] rounded-full bg-[#2d9bf0]\"\n                                    :class=\"active == 'PL_{{ $place->id }}' ? 'border-4 border-[#12CDD4] placeActive' : ''\">\n                                    <div class=\"flex align-item-center justify-center items-center h-full\">\n                                        <img src=\"{{ asset('new_img/image.png') }}\" class=\"w-7 h-7\" />\n                                    </div>\n                                </div>\n                                <span class=\"mt-4 text-black font-normal\">{{ $place->name }}</span>\n                            </div>\n                        @endforeach\n                        <div x-show=\"!showMore\" class=\"cursor-pointer\">\n                            <button @click=\"showMore = true; height = '100vh'\">\n                                <div class=\"rounded-full border-site border-4 p-[22px]\">\n                                    <svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\"\n                                        stroke-width=\"3\" stroke=\"currentColor\" class=\"w-6 h-6 font-bold color-site\">\n                                        <path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M12 6v12m6-6H6\" />\n                                    </svg>\n                                </div>\n                                <div class=\"mt-4 text-black font-normal\">See more</div>\n                            </button>\n                        </div>\n                    </div>\n                </div>\n\n                <div class=\"mt-12 mb-12 text-center\" x-data=\"{ subactive: '' }\" x-show=\"placeModel=='child'\">\n                    <div class=\"placeparent mb-10 font-semibold text-xl\"></div>\n                    <div class=\"grid grid-cols-3 italic font-semibold text-xl gap-10 subPlaceItems\">\n\n                    </div>\n                </div>\n\n                <div x-show=\"placeSubtab=='choose'\" class=\"px-5 mt-2 text-center\">\n\n                    Tap \"submit\" to pin this place to the map and share it with other users.\n                    Provide more details through rating, adding a description, and uploading a photo.\n\n\n                </div>\n\n                <div class=\"flex items-center justify-between w-2/3 pt-28 pb-16 font-semibold\">\n                    <label class=\"flex flex-col items-center gap-1 cursor-pointer\" for=\"image-upload\">\n                        <input id=\"image-upload\" type=\"file\" class=\"hidden place_image\" accept=\".jpg, .png\">\n                        <img src=\"{{ asset('img/cam-2.PNG') }}\" alt=\"\" class=\"w-10 h-9\">\n                        <div class=\"text-sm\">Upload image</div>\n                    </label>\n\n                    <div class=\"relative\" x-data=\"{ placeText: false }\">\n                        <div @click=\"placeText = !placeText\" class=\"flex flex-col items-center gap-1 cursor-pointer\">\n                            <img src=\"{{ asset('img/msg.PNG') }}\" alt=\"\" class=\"w-10 h-9\">\n                            <div class=\"text-sm\">Add description</div>\n                        </div>\n                        <textarea class=\"font-normal place_description absolute px-2 py-2 bg-white rounded-xl w-[300px] right-0\"\n                            x-show=\"placeText\"></textarea>\n                    </div>\n\n                </div>\n\n            </div>\n\n            <div class=\"observationSubTab flex flex-col items-center justify-center\" x-data=\"{\n                observationSubtab: 'add',\n                searchQueryObservation: '',\n                observationTitle: 'Want to pin an observation that has not been mapped before? Add a layer by giving it a name. Provide more details through rating, adding a description, and uploading a photo.',\n                observationInput: 'Enter a new observation',\n                active: '',\n                observationModel: 'parent'\n            }\"\n                x-show=\"tab=='observation'\" :class=\"observationSubtab == 'choose' ? 'choose' : 'add'\">\n\n                <button class=\"hidden OpenObservationModel\"\n                    @click=\"tab='observation';observationSubtab='choose';observationTitle='Choose tags or add a new observation';observationInput='Browse observation'\"></button>\n                <button class=\"hidden OpenSubObservationModel\"\n                    @click=\"tab='observation';observationModel='child'\"></button>\n\n\n                <div class=\"ObservationItems w-full\" x-show=\"observationModel=='parent'\"\n                    :class=\"observationModel == 'parent' ? 'parent' : 'child'\">\n                    <div class=\"flex flex-col items-center justify-center mt-12 mb-12 w-full\">\n                        <input type=\"text\" name=\"observation_name\" :placeholder=\"observationInput\"\n                            x-model=\"searchQueryObservation\" id=\"searchQueryObservation\" class=\"w-full px-4 py-2 bg-white rounded-full\">\n                        <div class=\"mt-2 italic font-normal text-center\" x-text=\"observationTitle\"></div>\n                    </div>\n                    <div class=\"flex items-start justify-center gap-10 mt-6 mb-6 italic font-semibold\">\n                        <div class=\"grid grid-cols-4 italic font-semibold gap-10\" x-show=\"observationSubtab=='choose'\">\n                            <div class=\"flex flex-col items-center cursor-pointer\">\n                                <button\n                                    @click=\"observationSubtab='add';observationTitle='Want to pin an observation that has not been mapped before? Add a layer by giving it a name. Provide more details through rating, adding a description, and uploading a photo.';observationInput='Enter a new observation'\">\n                                    <div class=\"rounded-full border-site border-4 p-[22px] bg-site\">\n                                        <svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\"\n                                            stroke-width=\"3\" stroke=\"#ffff\" class=\"w-6 h-6 font-bold color-site\">\n                                            <path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M12 6v12m6-6H6\" />\n                                        </svg>\n                                    </div>\n                                    <div class=\"mt-4 text-black font-bold\">Add new</div>\n                                </button>\n                            </div>\n                            @foreach ($allObservations as $key => $observation)\n                                <div x-data=\"{ active: false }\"\n                                    x-show=\"(showMore || {{ $key }} < 2) && (searchQueryObservation === '' || '{{ strtolower($observation->name) }}'.includes(searchQueryObservation.toLowerCase()))\"\n                                    class=\"flex flex-col items-center cursor-pointer\"\n                                    @click=\"active = !active ? 'OB_{{ $observation->id }}' : false\">\n                                    <div data-observations=\"{{ json_encode(['id' => $observation->id, 'name' => $observation->name, 'child' => $observation->subobservs]) }}\"\n                                        class=\"w-[76px] h-[76px] rounded-full bg-[#ffa726]\"\n                                        :class=\"active == 'OB_{{ $observation->id }}' ?\n                                            'border-4 border-[#12CDD4] observationActive' : ''\">\n                                        <div class=\"flex align-item-center justify-center items-center h-full\">\n                                            <img src=\"{{ asset('new_img/sad.png') }}\" alt=\"\"\n                                                class=\"w-8 h-8 -mr-1\">\n                                            <img src=\"{{ asset('new_img/happy.png') }}\" alt=\"\"\n                                                class=\"w-8 h-8 -ml-1\">\n                                        </div>\n                                    </div>\n                                    <span class=\"mt-4 text-black font-normal\">{{ $observation->name }}</span>\n                                </div>\n                            @endforeach\n\n                            <div x-show=\"!showMore\" class=\"flex flex-col items-center justify-center cursor-pointer\">\n                                <button @click=\"showMore = true; height = '100vh'\" type=\"button\">\n                                    <div class=\"rounded-full border-[#ffa726] border-4  p-[22px]\">\n                                        <svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\"\n                                            stroke-width=\"3\" stroke=\"currentColor\"\n                                            class=\"w-6 h-6 font-bold text-[#ffa726]\">\n                                            <path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M12 6v12m6-6H6\" />\n                                        </svg>\n                                    </div>\n                                    <div class=\"mt-4 text-black font-normal\">See more</div>\n                                </button>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <div class=\"mt-12 mb-12 text-center\" x-show=\"observationModel=='child'\">\n                    <div class=\"grid grid-cols italic font-semibold text-xl gap-10 subObservationItems\">\n\n                    </div>\n                </div>\n\n\n\n                <div x-show=\"observationSubtab=='add'\" x-data=\"{ feelActive: 'feel__1' }\"\n                    class=\"flex flex-wrap items-center justify-center gap-2 italic font-semibold w-full \">\n                    @foreach ($feelings as $feeling)\n                        <div data-feeling_id=\"{{ $feeling->id }}\" @click=\"feelActive='feel_{{ $feeling->id }}'\"\n                            class=\"cursor-pointer rounded-full\"\n                            :class=\"feelActive == 'feel_{{ $feeling->id }}' ? 'border-4 border-[#12CDD4] feelingActive' : ''\">\n                            <img class=\"w-12 h-12 sm:w-16 sm:h-16\" src=\"{{ asset($feeling->image) }}\" alt=\"\">\n                        </div>\n                    @endforeach\n\n                </div>\n\n\n                <div x-show=\"observationSubtab=='choose'\" class=\"px-5 mt-2 text-center\">\n\n                    Tap \"submit\" to pin this observation to the map and share it with other users.\n                    Provide more details through rating, adding a description, and uploading a photo.\n\n\n                </div>\n                <div class=\"flex items-center justify-between w-2/3 pt-28 pb-16 font-semibold\">\n                    <label for=\"obser-image-upload\" class=\"flex flex-col items-center gap-1 cursor-pointer\">\n                        <input id=\"obser-image-upload\" type=\"file\" class=\"hidden observation_image\"\n                            accept=\".jpg, .png\">\n                        <img src=\"{{ asset('img/cam.PNG') }}\" alt=\"\" class=\"w-10 h-9\">\n                        <div class=\"text-sm\">Upload image</div>\n                    </label>\n\n\n\n                    <div class=\"relative\" x-data=\"{ observationText: false }\">\n                        <div @click=\"observationText = !observationText\"\n                            class=\"flex flex-col items-center gap-1 cursor-pointer\">\n                            <img src=\"{{ asset('img/msg-2.PNG') }}\" alt=\"\" class=\"w-10 h-9\">\n                            <div class=\"text-sm\">Add description</div>\n                        </div>\n                        <textarea class=\"font-normal observation_description absolute px-2 py-2 bg-white rounded-xl w-[300px] right-0\"\n                            x-show=\"observationText\"></textarea>\n                    </div>\n\n                </div>\n\n\n            </div>\n\n\n            <div class=\"fixed left-0 right-0 bg-white py-4 bottom-0 z-[100]\">\n                <div class=\"flex items-center justify-center gap-6\">\n                    <a href=\"/\"\n                        class=\"flex cursor-pointer items-center justify-center border-2 border-site gap-2 px-8 py-3 text-lg font-extrabold color-site bg-white rounded-3xl transition-all\">\n                        Close\n                    </a>\n\n                    <div\n                        class=\"submitDataAll flex cursor-pointer items-center border-2 border-site justify-center gap-2 px-8 py-3 text-lg font-extrabold text-white bg-[#2d9bf0] rounded-3xl  hover:bg-[#268ede] transition-all\">\n                        Submit\n                    </div>\n                </div>\n            </div>\n        </div>\n\n    </div>\n\n    <script>\n\n$(document).ready(function () {\n    setTimeout(() => {\n        $('#searchQueryPlace').val(' ');\n        var inputEvent = new Event('input', { bubbles: true });\n        $('#searchQueryPlace')[0].dispatchEvent(inputEvent);\n        \n        $('#searchQueryObservation').val(' ');\n        var inputEvent = new Event('input', { bubbles: true });\n        $('#searchQueryObservation')[0].dispatchEvent(inputEvent);\n    }, 1);\n});\n\n        let place_data = {\n            place_name: '',\n            place_id: '',\n            child_place_id: '',\n            observation_name: '',\n            feeling_id: '',\n            observations: '',\n            place_description: '',\n            observation_description: '',\n            latitude: '',\n            longitude: '',\n            tab: '{{ $type }}',\n        };\n        var fileInput_place = '';\n        var fileInput_observation = '';\n\n        if (navigator.geolocation) {\n            getposition();\n        } else {\n            alert(\"Geolocation is not supported by this browser.\");\n        }\n\n        function getposition(success, fail) {\n            if (navigator && navigator.geolocation) {\n                navigator.geolocation.getCurrentPosition(\n                    function(pos) {\n                        place_data['latitude'] = pos.coords.latitude;\n                        place_data['longitude'] = pos.coords.longitude;\n                    }\n                );\n            }\n        }\n\n\n\n        $('body').on('click', '.submitDataAll', function() {\n\n            var parentDiv = $(this).closest('.parentDiv');\n\n\n\n\n\n\n            if (parentDiv.hasClass('placeTab')) {\n                tab = 'place';\n                place_data['tab'] = tab;\n\n                fileInput_place = $(\".place_image\")[0].files[0];\n                place_data['place_description'] = parentDiv.find('.place_description').val();\n\n\n                if (parentDiv.find('.' + tab + 'SubTab').hasClass('add')) {\n                    // add new place\n                    var name = parentDiv.find('input[name=\"place_name\"]').val();\n                    if (name == '') {\n                        parentDiv.find('input[name=\"place_name\"]').addClass('border-red-500');\n                        return false;\n                    }\n                    place_data['place_name'] = name;\n                } else if (parentDiv.find('.' + tab + 'SubTab').hasClass('choose') && parentDiv.find('.PlaceItems')\n                    .hasClass('parent')) {\n\n                    var place_detail = parentDiv.find('.placeActive').data('place');\n\n\n                    if (typeof place_detail === 'undefined') {\n                        return false;\n                    }\n                    place_data['place_id'] = place_detail.id;\n                    if (place_detail.child.length > 0) {\n                        $('.placeparent').text(place_detail.name);\n                        var allHtml = '';\n                        place_detail.child.forEach(place => {\n                            allHtml += `\n                            <div class=\"flex flex-col items-center cursor-pointer\" @click=\"subactive='SPL_${place.id}'\">\n                                                <div data-subplaceid=\"${place.id}\" class=\"w-[76px] h-[76px] rounded-full bg-[#2d9bf0]\"\n                                                :class=\"subactive == 'SPL_${place.id}' ? 'border-4 border-[#12CDD4] subplaceActive' : ''\">\n                                                    <div class=\"flex align-item-center justify-center items-center h-full\">\n                                                        <img src=\"{{ asset('new_img/image.png') }}\" class=\"w-7 h-7\" />\n                                                    </div>\n                                                </div>\n                                                <span class=\"mt-4 text-black font-normal text-base\">${place.name}</span>\n                                            </div>\n                            `;\n                        });\n                        $('.subPlaceItems').html(allHtml);\n                        $('.OpenSubPlaceModel').click();\n                        return false;\n                    } else {\n                        submitDetailData(place_data);\n                    }\n\n                } else if (parentDiv.find('.' + tab + 'SubTab').hasClass('choose') && parentDiv.find('.PlaceItems')\n                    .hasClass('child')) {\n\n\n                    var subplace_id = parentDiv.find('.subplaceActive').data('subplaceid');\n                    place_data['child_place_id'] = subplace_id ? subplace_id : '';\n                }\n            }\n\n            if (parentDiv.hasClass('observationTab')) {\n                tab = 'observation';\n                place_data['tab'] = tab;\n                fileInput_observation = $(\".observation_image\")[0].files[0];\n                place_data['observation_description'] = parentDiv.find('.observation_description').val();\n\n                if (parentDiv.find('.' + tab + 'SubTab').hasClass('add')) {\n                    // add new observation\n                    var name = parentDiv.find('input[name=\"observation_name\"]').val();\n                    var feeling = parentDiv.find('.feelingActive').data('feeling_id');\n\n                    if (name === '' || typeof feeling === 'undefined') {\n                        parentDiv.find('input[name=\"observation_name\"]').addClass('border-red-500');\n                        return false;\n                    }\n                    place_data['observation_name'] = name;\n                    place_data['feeling_id'] = feeling;\n                } else if (parentDiv.find('.' + tab + 'SubTab').hasClass('choose') && parentDiv.find(\n                        '.ObservationItems').hasClass('parent')) {\n                    // choose observation\n                    var observations_detail = [];\n                    parentDiv.find('.observationActive').each(function() {\n                        var data = $(this).data('observations');\n                        observations_detail.push(data);\n                    });\n                    var allHtml = '';\n                    if (observations_detail.length == 0) {\n                        return false;\n                    }\n                    observations_detail.forEach(function(observation) {\n\n                        allHtml +=\n                            `<div data-observation_id=\"${observation.id}\"><div class=\"mb-4\">${observation.name}</div>`;\n\n                        var feelingHtml = `\n                                <div x-data=\"{ feelActive${observation.id}: 'feel_${observation.id}_1' }\" class=\"flex flex-wrap items-center justify-center gap-2 italic font-semibold w-full \">\n                                    @foreach ($feelings as $feeling)\n                                        <div data-feeling_id=\"{{ $feeling->id }}\"\n                                            @click=\"feelActive${observation.id}='feel_${observation.id}_{{ $feeling->id }}'\"\n                                            class=\"cursor-pointer rounded-full\"\n                                            :class=\"feelActive${observation.id} == 'feel_${observation.id}_{{ $feeling->id }}' ? 'border-4 border-[#12CDD4] feelingActive' : ''\"\n                                            >\n                                            <img class=\"w-12 h-12 sm:w-16 sm:h-16\" src=\"{{ asset($feeling->image) }}\" alt=\"\">\n                                        </div>\n                                    @endforeach\n                                </div>\n                    `;\n\n                        if (observation.child.length === 0) {\n                            allHtml += `\n                            <div data-subobservation_id=\"\" class=\"flex items-center justify-between mb-10\">\n                            ${feelingHtml}\n                            </div>\n                        `;\n                        } else {\n                            observation.child.forEach(observ => {\n                                allHtml += `\n                            <div data-subobservation_id=\"${observ.id}\" class=\"flex gap-2 lg:gap-20 items-center justify-between mb-10\">\n                                <div class=\"flex flex-col items-center w-[160px]\">\n                                    <div class=\"w-[76px] h-[76px] rounded-full bg-[#ffa726]\">\n                                        <div class=\"flex align-item-center justify-center items-center h-full\">\n                                            <img src=\"{{ asset('new_img/sad.png') }}\" alt=\"\"\n                                                            class=\"w-8 h-8 -mr-1\"> <img\n                                                            src=\"{{ asset('new_img/happy.png') }}\" alt=\"\"\n                                                            class=\"w-8 h-8 -ml-1\">\n                                        </div>\n                                    </div>\n                                    <span class=\"mt-1 text-black font-normal text-base\">${observ.name}</span>\n                                </div>\n\n                                ${feelingHtml}\n                            </div>`;\n                            });\n                        }\n\n                        allHtml += `</div>`;\n                    });\n\n                    $('.subObservationItems').html(allHtml);\n                    $('.OpenSubObservationModel').click();\n                    return false;\n                } else if (parentDiv.find('.' + tab + 'SubTab').hasClass('choose') && parentDiv.find(\n                        '.ObservationItems').hasClass('child')) {\n\n                    var dataList = [];\n                    parentDiv.find('.feelingActive').each(function() {\n                        var observationId = $(this).closest('[data-observation_id]').data('observation_id');\n                        var subobservationId = $(this).closest('[data-subobservation_id]').data(\n                            'subobservation_id');\n                        var feelingId = $(this).data('feeling_id');\n\n                        dataList.push({\n                            observation_id: observationId,\n                            child_observation_id: subobservationId,\n                            feeling_id: feelingId\n                        });\n                    });\n                    place_data['observations'] = dataList;\n                }\n            }\n            // console.log(place_data);\n            submitDetailData(place_data);\n        });\n\n        var totalswal = 0;\n\n        function submitDetailData(place_data) {\n\n            place_data['update'] = place_data.tab;\n\n            @if ($edit_id)\n                place_data['place_detail_id'] = {{ $edit_id }};\n            @endif\n\n            const formData = new FormData();\n            if (fileInput_place) {\n                formData.append('place_image', fileInput_place);\n            }\n            if (fileInput_observation) {\n                formData.append('observation_image', fileInput_observation);\n            }\n\n            formData.append('place_data', JSON.stringify(place_data));\n\n            $.ajaxSetup({\n                headers: {\n                    'X-CSRF-TOKEN': $('meta[name=\"csrf-token\"]').attr('content')\n                }\n            });\n\n\n            $.ajax({\n                type: 'POST',\n                url: \"/map/add/place\",\n                data: formData,\n                contentType: false,\n                processData: false,\n                success: function(data) {\n                    if (data.status == 'success') {\n                        place_data['place_name'] = '';\n                        place_data['observation_name'] = '';\n                        place_data['place_id'] = data.place_id;\n\n                        var reverse_tab = data.tab == 'place' ? 'observation' : 'place';\n                        if (data.status == 'success') {\n\n                            if (totalswal >= 1) {\n                                window.location.href = '/';\n                            } else {\n                                totalswal = totalswal + 1;\n                                place_data['place_detail_id'] = data.place_detail_id;\n                                place_data['update'] = reverse_tab;\n\n                                @if(!$only)\n                                    swal({\n                                        title: \"Success!\",\n                                        text: data.tab.charAt(0).toUpperCase() + data.tab.slice(1) + \" \" +\n                                            data\n                                            .msg + \" Do you want to add \" + reverse_tab + \" tag?\",\n                                        icon: \"success\",\n                                        buttons: [\"Close\", \"Continue\"],\n                                    }).then((userConfirmed) => {\n                                        if (userConfirmed) {\n                                            if (reverse_tab == 'place') {\n                                                $('.openPlaceModel').click();\n                                            } else {\n                                                $('.OpenObservationModel').click();\n                                            }\n                                        } else {\n                                            window.location.href = '/';\n                                            // $('.closeAddProcess').click();\n                                        }\n                                    });\n                                @else\n                                    window.location.href = '/';\n                                @endif\n\n\n                                \n                            }\n\n\n                        }\n                    } else {\n                        swal({\n                            title: \"Failed!\",\n                            text: data.msg,\n                            icon: \"error\"\n                        });\n                    }\n\n\n                },\n\n            });\n\n        }\n    </script>\n@endsection\n"
        }
    ]
}